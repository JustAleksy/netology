# Домашнее задание к занятию «Микросервисы: подходы»
----------------------------------------------------------------
## Задача 1: Обеспечить разработку
Для обеспечения процесса разработки, включающего хранение исходного кода, непрерывную интеграцию (CI) и непрерывную поставку (CD), предлагаемое решение будет включать в себя использование следующих инструментов и сервисов:

1. **GitHub** как система контроля версий и хостинг для репозиториев кода.
2. **Jenkins** для организации процессов CI/CD.
3. **Docker** для управления контейнерами и создания собственных докер-образов.
4. **Vault by HashiCorp** для безопасного хранения секретных данных.
5. **Kubernetes** для оркестрации контейнеров и развертывания агентов сборки.

### Обоснование выбора инструментов

#### 1. GitHub

**Почему GitHub:**
- **Облачная система**: GitHub предлагает облачное решение для хостинга репозиториев.
- **Система контроля версий Git**: Поддержка Git из коробки.
- **Репозиторий на каждый сервис**: Легкость управления множеством репозиториев для разных микросервисов.
- **Интеграция с CI/CD системами**: Отличная интеграция с Jenkins и другими CI/CD инструментами.

#### 2. Jenkins

**Почему Jenkins:**
- **Запуск сборки по событию из системы контроля версий**: Поддержка webhook'ов для триггеров сборок при пуше в GitHub.
- **Запуск сборки по кнопке с указанием параметров**: Интерфейс позволяет запускать сборки вручную с кастомными параметрами.
- **Настройки для каждой сборки и шаблоны для различных конфигураций**: Возможность создания джобов с различными конфигурациями и использованием шаблонов.
- **Безопасное хранение секретных данных**: Интеграция с HashiCorp Vault для хранения секретов.
- **Несколько конфигураций для сборки из одного репозитория**: Настройка множества джобов с разными параметрами для одного репозитория.
- **Кастомные шаги при сборке**: Поддержка написания собственных шагов в pipeline.
- **Собственные докер-образы для сборки проектов**: Интеграция с Docker для использования кастомных образов.
- **Развертывание агентов сборки на собственных серверах**: Возможность развертывания агентов на любых серверах, включая облачные и локальные.
- **Параллельный запуск сборок и тестов**: Поддержка параллельного выполнения задач.

#### 3. Docker

**Почему Docker:**
- **Управление контейнерами**: Простота создания, развертывания и управления контейнерами.
- **Собственные докер-образы для сборки проектов**: Возможность создания и использования кастомных образов для специфических нужд сборки и тестирования.
- **Интеграция с Jenkins и Kubernetes**: Легкость интеграции с Jenkins для CI/CD процессов и Kubernetes для оркестрации.

#### 4. HashiCorp Vault

**Почему Vault:**
- **Безопасное хранение секретных данных**: Надежное управление секретами, ключами доступа и паролями.
- **Интеграция с Jenkins**: Простая интеграция для использования секретов в CI/CD pipeline.

#### 5. Kubernetes

**Почему Kubernetes:**
- **Оркестрация контейнеров**: Управление контейнерами в продакшн среде, включая автоматическое масштабирование и балансировку нагрузки.
- **Развертывание агентов сборки на собственных серверах**: Возможность развертывания Jenkins agents в виде подов в кластере Kubernetes.
- **Параллельный запуск сборок и тестов**: Эффективное управление ресурсами для параллельного выполнения задач.

### Архитектура решения

#### Хранение исходного кода
- Использование GitHub для хранения исходного кода. Каждый микросервис имеет свой отдельный репозиторий.

#### Непрерывная интеграция и поставка
- Jenkins настроен для мониторинга репозиториев GitHub. Webhook'и настраиваются для запуска сборок при каждом пуше или пулл-реквесте.
- Для каждой сборки настраивается pipeline с параметрами, позволяющими конфигурировать сборку в зависимости от среды и других параметров.
- Jenkins хранит шаблоны конфигураций для различных типов сборок (например, для разработки, тестирования, продакшн).

#### Безопасное хранение секретных данных
- HashiCorp Vault используется для безопасного хранения и управления секретами, которые могут понадобиться в процессе сборки и развертывания.

#### Контейнеризация и оркестрация
- Docker используется для создания и управления контейнерами.
- Собственные докер-образы создаются и используются в процессах сборки и тестирования.
- Kubernetes управляет развертыванием Jenkins agents, обеспечивая параллельное выполнение сборок и тестов.

----------------------------------------------------------------

## Задача 2: Логи

Для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре предлагаемое решение будет включать использование следующих инструментов и сервисов:

1. **Fluentd** для агрегации и доставки логов.
2. **Elasticsearch** для хранения и поиска по логам.
3. **Kibana** для визуализации и анализа логов.

### Обоснование выбора инструментов

#### 1. Fluentd

**Почему Fluentd:**
- **Сбор логов в центральное хранилище со всех хостов**: Fluentd может собирать логи со всех узлов и отправлять их в централизованное хранилище.
- **Минимальные требования к приложениям**: Fluentd может собирать логи из stdout.
- **Гарантированная доставка логов до центрального хранилища**: Поддержка буферизации и подтверждений доставки.
- **Интеграция с различными источниками и приемниками**: Поддержка множества плагинов для интеграции с различными системами.

#### 2. Elasticsearch

**Почему Elasticsearch:**
- **Обеспечение поиска и фильтрации по записям логов**: Elasticsearch предоставляет мощные возможности для поиска и фильтрации данных.
- **Масштабируемость**: Возможность масштабирования для обработки больших объемов логов.
- **Гарантированная доставка**: Интеграция с Fluentd для надежной доставки логов.

#### 3. Kibana

**Почему Kibana:**
- **Обеспечение пользовательского интерфейса**: Kibana предоставляет интерфейс для визуализации и анализа логов.
- **Поиск и фильтрация**: Поддержка поиска и фильтрации по записям логов.
- **Сохраненные запросы**: Возможность сохранять запросы и делиться ссылками на них.

### Архитектура решения

#### Сбор логов

- **Fluentd** установлен на каждом хосте для сбора логов из stdout приложений.
- Логи буферизуются и отправляются в **Elasticsearch**.

#### Хранение и поиск логов

- **Elasticsearch** используется как центральное хранилище для логов, обеспечивая возможность поиска и фильтрации.

#### Визуализация и анализ логов

- **Kibana** подключен к Elasticsearch для визуализации логов.
- Разработчики и другие пользователи могут использовать Kibana для поиска и анализа логов, а также создавать и сохранять запросы.

----------------------------------------------------------------

## Задача 3: Мониторинг

Для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре предлагаемое решение будет включать использование следующих инструментов и сервисов:

1. **Prometheus** для сбора и хранения метрик.
2. **Grafana** для визуализации и анализа метрик.

### Обоснование выбора инструментов

#### 1. Prometheus

**Почему Prometheus:**
- **Сбор метрик со всех хостов**: Prometheus может собирать метрики со всех узлов и сервисов.
- **Сбор метрик состояния ресурсов хостов**: Поддержка экспортеров для сбора метрик CPU, RAM, HDD и Network.
- **Сбор метрик потребляемых ресурсов для каждого сервиса**: Возможность мониторинга ресурсов, используемых каждым сервисом.
- **Сбор метрик, специфичных для каждого сервиса**: Легкость интеграции с различными сервисами для сбора специфичных метрик.
- **Гарантированная доставка метрик**: Надежная доставка и хранение метрик.

#### 2. Grafana

**Почему Grafana:**
- **Пользовательский интерфейс для запросов и агрегации информации**: Grafana предоставляет мощный интерфейс для создания запросов и агрегации данных.
- **Настраиваемые панели для отслеживания состояния системы**: Возможность создания кастомных дашбордов для мониторинга различных аспектов системы.
- **Интеграция с Prometheus**: Легкость интеграции с Prometheus для получения метрик.

### Архитектура решения

#### Сбор метрик

- **Prometheus** установлен для сбора метрик со всех хостов и сервисов.
- Использование экспортеров для сбора метрик состояния ресурсов хостов: CPU, RAM, HDD, Network.
- Интеграция с сервисами для сбора метрик потребляемых ресурсов: CPU, RAM, HDD, Network, а также специфичных метрик для каждого сервиса.

#### Хранение и анализ метрик

- **Prometheus** используется для хранения метрик и предоставления возможностей для их анализа.

#### Визуализация и мониторинг

- **Grafana** подключен к Prometheus для визуализации метрик.
- Создание кастомных дашбордов для мониторинга состояния системы, хостов и сервисов.
